setwd('/home/marcello/Skinner/Teaching/mib/amd/2014/Esami/Gennaio14')
write.csv(d,file='dati1.csv')
library(simCity)
dat<-data.frame(a=1:3,b=1:2)
dat<-data.frame(a=1:2,b=1:2)
dat
exdist(mm)<-categorical
d<-make.data(mm,100,rep(1,4))
head(d)
mm
mm<-simc.model()
dat<-data.frame(a=1:2,b=1:2)
exdist(mm)<-categorical
mm
d<-make.data(mm,100,rep(1,4))
head(d)
mm
d<-make.data(mm,100,rep(1,4))
exdist(mm)<-categorical
mm
d<-make.data(mm,100,rep(1,4))
myexcov<-data.frame(x=c(1,0),z=c(0,1))
myexcov
s<-list(a=c(0:1),b=c(0:2)) # a 2 X 3 to be reduced to 2 X 2
e<-expand.grid(s)
e
class(e)
library(simCity)
myexcov<-data.frame(x=c(1,0),z=c(0,1))
myexcov
myexdist(10,e,myexcov)
categorical(100,myexcov)
table(d$x,d$y)
table(d$x,d$z)
myexcov<-data.frame(x=c(1,0),z=c(0,1))
d<-categorical(100,myexcov)
table(d$x,d$z)
expand.grid(myexcov)
e<-expand.grid(myexcov)
d<-categorical(100,e)
table(d$x,d$z)
d<-categorical(110,e)
table(d$x,d$z)
library(simCity)
mm<-simc.model()
dat<-data.frame(a=1:2,b=1:2)
exdist(mm)<-categorical
mm
d<-make.data(mm,100,rep(1,4))
head(d)
table(d$a,d$b)
exdist(mm)<-categorical
mm<-simc.model()
dat<-data.frame(a=1:2,b=1:2)
exdist(mm)<-categorical
exmeans(mm)<-dat
mm
d<-make.data(mm,100,rep(1,4))
dat<-matrix(a=1:2,b=1:2)
dat<-matrix(c(1,0),c(1,1))
dat
dat<-matrix(c(c(1,0),c(1,1)))
dat
dat<-matrix(c(c(1,0,1,1)))
dat
dat<-matrix(c(c(1,0,1,1),c(0,0,1,1)))
dat
dat<-matrix(c(c(1,0,1,1),c(0,0,1,1)),ncol=2)
dat
dat<-matrix(c(a=c(1,0,1,1),b=c(0,0,1,1)),ncol=2)
dat
dat<-matrix(list(a=c(1,0,1,1),b=c(0,0,1,1)),ncol=2)
dat
dat<-matrix(c(a=c(1,0,1,1),b=c(0,0,1,1)),ncol=2)
dat
colnames(dat)<-c('a','b')
dat
mm<-simc.model()
dat<-matrix(c(a=c(1,0,1,1),b=c(0,0,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
y~1+ a1+b1+a1b1
#
mm<-simc.model()
equations(mm)
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
mm<-simc.model()
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
equations(mm)
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
library(simCity)
mm<-simc.model()
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
library(simCity)
mm<-simc.model()
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
library(simCity)
mm<-simc.model()
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
library(simCity)
mm<-simc.model()
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
head(d)
library(simCity)
mm<-simc.model()
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
library(simCity)
mm<-simc.model()
dat<-matrix(c(a=c(1,0,1,1,0),b=c(0,0,1,1,1)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
debug(make.data)
d<-make.data(mm,100,rep(1,4))
undebug(make.data)
debug(categorical)
d<-make.data(mm,100,rep(1,4))
undebug(categorical)
exdist(mm)<-rmnorm(0,1)
exdist(mm)<-rmnorm
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
exdist(mm)<-scale
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
exdist(mm)<-nothin
exdist(mm)<-nothing
null()
exdist(mm)<-is.null
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
mm
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
exdist(mm)<-categorical
mm
d<-make.data(mm,100,rep(1,4))
library(simCity)
d<-make.data(mm,100,rep(1,4))
library(simCity)
exdist(mm)<-categorical
d<-make.data(mm,100,rep(1,4))
library(simCity)
exdist(mm)<-categorical
d<-make.data(mm,100,rep(1,4))
library(simCity)
exdist(mm)<-categorical
d<-make.data(mm,100,rep(1,4))
library(simCity)
exdist(mm)<-categorical
d<-make.data(mm,100,rep(1,4))
dat
library(simCity)
exdist(mm)<-categorical
d<-make.data(mm,100,rep(1,4))
head(d)
dat
d<-make.data(mm,100,rep(1,4))
table(d$a,d$b)
mm<-simc.model()
dat<-matrix(c(a=c(1,0,1,0,0,1),b=rep(c(1,2,3),2),ncol=2)
colnames(dat)<-c('a','b')
dat
mm
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
head(d)
table(d$a,d$b)
dat<-matrix(c(a=c(1,0,1,0,0,1),b=rep(c(1,2,3),2),ncol=2)
dat
dat<-matrix(c(a=c(1,0,1,0,0,1),b=rep(c(1,2,3),2),ncol=2)
dat
dat<-matrix(c(a=c(1,0,1,0,0,1),b=rep(c(1,2,3),rep2),ncol=2)
dat<-matrix(c(a=c(1,0,1,0,0,1),b=rep(c(1,2,3),rep=2),ncol=2)
rep(c(1,2,3),rep=2)
rep(c(1,2,3),2)
dat<-matrix(c(a=c(1,0,1,0,0,1),b=rep(c(1,2,3),2),ncol=2)
dat<-matrix(c(a=c(1,0,1,0,0,1),b=rep(c(1,2,3),2),ncol=2))
dat
dat<-matrix(c(a=c(1,0,1,0,0,1),b=rep(c(1,2,3),2))ncol=2)
dat
dat<-matrix(c(a=c(1,0,1,0,0,1),b=rep(c(1,2,3),2))ncol=2)
dat<-matrix(c(1,0,1,0,0,1,rep(c(1,2,3),2))ncol=2)
dat<-matrix(c(1,0,1,0,0,1,rep(c(1,2,3),2)),ncol=2)
dat
dat<-matrix(c(1,0,1,0,0,1,rep(c(1,2,3),2)),ncol=2)
colnames(dat)<-c('a','b')
dat
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
categorical.formula(dat)
dat<-matrix(c(1,0,1,0,0,1,rep(c(1,2,3),2)),ncol=2)
colnames(dat)<-c('a','b')
categorical.formula(dat)
colnames(dat)
categorical.formula(dat)
library(simCity)
categorical.formula(dat)
mm<-simc.model()
dat<-matrix(c(1,0,1,0,0,1,rep(c(1,2,3),2)),ncol=2)
colnames(dat)<-c('a','b')
categorical.formula(dat)
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
head(d)
table(d$a,d$b)
dat
dat<-matrix(c(rep(c(1,2),each=3),rep(c(1,2,3),2)),ncol=2)
colnames(dat)<-c('a','b')
dat
dat<-matrix(c(rep(c(1,2),each=3),rep(c(1,2,3),2)),ncol=2)
colnames(dat)<-c('a','b')
dat
categorical.formula(dat)
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,4))
head(d)
dat
dat<-matrix(c(rep(c(1,2),each=3),rep(c(1,2,3),2)),ncol=2)
colnames(dat)<-c('a','b')
dat
categorical.formula(dat)
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,6))
head(d)
table(d$a,d$b)
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,6))
head(d)
dat
categorical.formula(dat)
mm<-simc.model()
dat<-matrix(c(rep(c(1,2),each=3),rep(c(1,2,3),2)),ncol=2)
colnames(dat)<-c('a','b')
dat
categorical.formula(dat)
exdist(mm)<-categorical
exmeans(mm)<-dat
d<-make.data(mm,100,rep(1,6))
head(d)
table(d$a,d$b)
library(simCity)
d<-make.data(mm,120,rep(1,6))
head(d)
table(d$a,d$b)
rcategorical<-function(n,info,cov) {
dat<-data.frame(a=rbinom(n,1,.5),b=rbinom(n,1,.5))
categorical(n,dat)
}
mm<-simc.model()
exdist(mm)<-rcategorical
d<-make.data(mm,100,rep(1,4))
head(d)
table(d$a,d$b)
rcategorical<-function(n,info,cov) {
dat<-data.frame(a=rbinom(n,1,info[1]),b=rbinom(n,1,info[2]))
categorical(n,dat)
}
oneblockfun<-function(simdata,arguments) {
mlm<-lm(y~a1+b1+a1b1,data=simdata)## do something usefull on this
dat<-matrix(c(arguments$model$exmeans,t(coef(mlm))),nrow=1)
colnames(dat)<-c('p1','p2',names(coef(mlm)))
data.frame(dat)
}
mm<-simc.model()
exdist(mm)<-rcategorical
exper<-experiment(mm,N=c(20,30,40),rep=1,fun.oneblock=oneblockfun)
coefs(exper)<-list(c(2,1,2,3),c(2,1.1,2.1,3.1),c(2,1.2,2.2,3.3))
proportions<-list(c(.5,.2),c(.5,.3),c(.5,.4),c(.5,.5))
res<-lapply(proportions, function(e) {
exmeans(mm)<-e
exper<-update(exper,mm)
run(exper)
})
res
do.call('rbind',res)
rcategorical<-function(n,info,cov) {
dat<-data.frame(a=rbinom(n,1,info[1]),b=rbinom(n,1,info[2]))
categorical(n,dat)
}
oneblockfun<-function(simdata,arguments) {
mlm<-lm(y~a1+b1+a1b1,data=simdata)## do something usefull on this
dat<-matrix(c(arguments$model$exmeans,t(coef(mlm))),nrow=1)
colnames(dat)<-c('p1','p2',names(coef(mlm)))
data.frame(dat)
}
mm<-simc.model()
exdist(mm)<-rcategorical
exper<-experiment(mm,N=c(20,30,40),rep=1,fun.oneblock=oneblockfun)
coefs(exper)<-list(c(2,1,2,3),c(2,1.1,2.1,3.1),c(2,1.2,2.2,3.3))
proportions<-list(c(.5,.2),c(.5,.3),c(.5,.4),c(.5,.5))
res<-lapply(proportions, function(e) {
exmeans(mm)<-e
exper<-update(exper,mm)
run(exper)
})
res
do.call('rbind',res)
myexdist<-function(n,info,cov) {
catdata<-categorical(n,info,list(a='contr.treatment',b='contr.treatment'))
condata<-rmnorm(n,varcov=as.matrix(cov))
cbind(catdata,condata)
}
myexdist(10,e,myexcov)
myexcov<-data.frame(x=c(1,0),z=c(0,1))
d<-categorical(100,myexcov)
myexcov<-data.frame(x=c(1,0),z=c(0,1))
e<-expand.grid(myexcov)
d<-categorical(110,e)
table(d$x,d$z)
rownames(myexcov)<-colnames(myexcov)
e<-expand.grid(a=c(1,2),b=c(1,2,3))
mm<-simc.model(exdist=myexdist,exmeans=e,excov=myexcov)
d<-make.data(mm,250,rep(1,8))
head(d)
summary(lm(y~a2+b2+b3+a2b2+a2b3+x+z,data=d))
options('contrasts')
summary(lm(y~factor(a)*factor(b)+x+z,data=d))
cor(d$z,d$x)
myexdist<-function(n,info,cov) {
catdata<-categorical(n,info,list(a='contr.treatment',b='contr.treatment'))
condata<-rmnorm(n,varcov=as.matrix(cov))
cbind(catdata,condata)
}
myexdist(10,e,myexcov)
myexcov<-data.frame(x=c(1,0),z=c(0,1))
d<-categorical(100,myexcov)
myexcov<-data.frame(x=c(1,0),z=c(0,1))
e<-expand.grid(myexcov)
d<-categorical(110,e)
d
table(d$x,d$z)
rownames(myexcov)<-colnames(myexcov)
e<-expand.grid(a=c(1,2),b=c(1,2,3))
myexcov<-data.frame(x=c(1,0),z=c(0,1))
d<-categorical(100,myexcov)
myexcov<-data.frame(x=c(1,0),z=c(0,1))
e<-expand.grid(myexcov)
d<-categorical(110,e)
d
table(d$x,d$z)
rownames(myexcov)<-colnames(myexcov)
e<-expand.grid(a=c(1,2),b=c(1,2,3))
mm<-simc.model(exdist=myexdist,exmeans=e,excov=myexcov)
d<-make.data(mm,250,rep(1,8))
head(d)
summary(lm(y~a2+b2+b3+a2b2+a2b3+x+z,data=d))
options('contrasts')
summary(lm(y~factor(a)*factor(b)+x+z,data=d))
cor(d$z,d$x)
summary(lm(y~factor(a)*factor(b)+x+z,data=d))
myexcov<-data.frame(x=c(1,.4),z=c(.4,1))
excov(mm)<-myexcov
d<-make.data(mm,250,rep(1,8))
head(d)
summary(lm(y~a2+b2+b3+a2b2+a2b3+x+z,data=d))
options('contrasts')
summary(lm(y~factor(a)*factor(b)+x+z,data=d))
cor(d$z,d$x)
library(simCity)
library(car)
s<-list(a=c(0:1)) # one way design
ethero<-function(n,x) {
r<-lapply(x, function(e) ifelse(e==0,rnorm(1,0,2),rnorm(1,0,1)))
unlist(r)
}
mm<-simc.model()
## check everything is ok
equations(mm,c(2))
exdist(mm)<-categorical.ortho
exmeans(mm)<-s
d<-make.data(mm,100,c(2))
leveneTest(d$y,d$a,center="mean")
var(d$y[d$a==0])
var(d$y[d$a!=0])
## set up and run the experiment
oneblockfun<-function(simdata,arguments) {
data.frame(coef=arguments$coefs,
p1=t.test(simdata$y~simdata$a,var.equal=T)$p.value,
p2=t.test(simdata$y~simdata$a,var.equal=F)$p.value)
}
myexp<-experiment(mm,rep=10,N=c(20,40,60,80),fun.oneblock=oneblockfun)
coefs(myexp)<-list(0,.5,1)
run(myexp)
library(simCity)
s<-list(a=c(0:1),b=c(0:2),c=c(0:1)) # a 2 X 3 X 2 design
con<-list(a='contr.poly')
d<-categorical.ortho(96,s,con)
table(a=d$a,b=d$b,c=d$c)
categorical.formula(s)
mm<-simc.model()
exdist(mm)<-categorical.ortho
excov(mm)<-NULL
exmeans(mm)<-s
d<-make.data(mm,96,rep(1,12))
head(d)
s<-list(a=c(0:1),b=c(0:2),c=c(0:1)) # a 2 X 3 X 2 design
s
library(simCity)
s<-list(a=c(0:1),b=c(0:2),c=c(0:1)) # a 2 X 3 X 2 design
s
names(s)
colnames(s)
colnames(s)<-names(s)
library(simCity)
s<-list(a=c(0:1),b=c(0:2),c=c(0:1)) # a 2 X 3 X 2 design
con<-list(a='contr.poly')
d<-categorical.ortho(96,s,con)
table(a=d$a,b=d$b,c=d$c)
categorical.formula(s)
mm<-simc.model()
exdist(mm)<-categorical.ortho
excov(mm)<-NULL
exmeans(mm)<-s
d<-make.data(mm,96,rep(1,12))
head(d)
s<-list(a=c(0:1),b=c(0:2),c=c(0:1)) # a 2 X 3 X 2 design
mm<-simc.model()
exdist(mm)<-categorical.ortho
excov(mm)<-NULL
exmeans(mm)<-s
d<-make.data(mm,96,rep(1,12))
head(d)
table(a=d$a,b=d$b,c=d$c)
library(simCity)
